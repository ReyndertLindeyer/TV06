[homing_override]
gcode:
  {% set th = printer.toolhead %}
  {% set home_all = 'X' not in params and 'Y' not in params and 'Z' not in params %}

  {% if home_all or 'Y' in params or ('Z' in params and 'y' not in th.homed_axes) %}
    _HOME_Y
  {% endif %}

  {% if home_all or 'X' in params or ('Z' in params and 'x' not in th.homed_axes) %}
    _HOME_X
  {% endif %}

  {% if home_all or 'Z' in params %}
    _HOME_Z
  {% endif %}

